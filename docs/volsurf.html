<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Notes</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Notes">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Notes" />
  
  
  

<meta name="author" content="Ivan Tan">


<meta name="date" content="2017-03-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="payoff.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Diffusion</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#basket"><i class="fa fa-check"></i><b>1.1</b> Basket</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#worstof"><i class="fa fa-check"></i><b>1.2</b> Worst-of</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#bestof"><i class="fa fa-check"></i><b>1.3</b> Best-of</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="volsurf.html"><a href="volsurf.html"><i class="fa fa-check"></i><b>2</b> Volatility Surface</a><ul>
<li class="chapter" data-level="2.1" data-path="volsurf.html"><a href="volsurf.html#implied-vol-surface"><i class="fa fa-check"></i><b>2.1</b> Implied vol surface</a></li>
<li class="chapter" data-level="2.2" data-path="volsurf.html"><a href="volsurf.html#local-vol-surface"><i class="fa fa-check"></i><b>2.2</b> Local vol surface</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="payoff.html"><a href="payoff.html"><i class="fa fa-check"></i><b>3</b> Payoff</a><ul>
<li class="chapter" data-level="3.1" data-path="payoff.html"><a href="payoff.html#noncallable"><i class="fa fa-check"></i><b>3.1</b> Noncallable</a><ul>
<li class="chapter" data-level="3.1.1" data-path="payoff.html"><a href="payoff.html#digitals"><i class="fa fa-check"></i><b>3.1.1</b> Digitals</a></li>
<li class="chapter" data-level="3.1.2" data-path="payoff.html"><a href="payoff.html#pdi"><i class="fa fa-check"></i><b>3.1.2</b> Put Down and In</a></li>
<li class="chapter" data-level="3.1.3" data-path="payoff.html"><a href="payoff.html#cuo"><i class="fa fa-check"></i><b>3.1.3</b> Call Up and Out</a></li>
<li class="chapter" data-level="3.1.4" data-path="payoff.html"><a href="payoff.html#combinations"><i class="fa fa-check"></i><b>3.1.4</b> Combinations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="payoff.html"><a href="payoff.html#autocallable"><i class="fa fa-check"></i><b>3.2</b> Autocallable</a><ul>
<li class="chapter" data-level="3.2.1" data-path="payoff.html"><a href="payoff.html#apollon"><i class="fa fa-check"></i><b>3.2.1</b> Snowball</a></li>
<li class="chapter" data-level="3.2.2" data-path="payoff.html"><a href="payoff.html#phoenix"><i class="fa fa-check"></i><b>3.2.2</b> Phoenix</a></li>
<li class="chapter" data-level="3.2.3" data-path="payoff.html"><a href="payoff.html#fcn"><i class="fa fa-check"></i><b>3.2.3</b> Fixed Coupons Notes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="payoff.html"><a href="payoff.html#issuercallable"><i class="fa fa-check"></i><b>3.3</b> Issuercallable</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sensi.html"><a href="sensi.html"><i class="fa fa-check"></i><b>4</b> Sensitivity</a><ul>
<li class="chapter" data-level="4.1" data-path="sensi.html"><a href="sensi.html#vol"><i class="fa fa-check"></i><b>4.1</b> Vol</a></li>
<li class="chapter" data-level="4.2" data-path="sensi.html"><a href="sensi.html#correl"><i class="fa fa-check"></i><b>4.2</b> Correl</a></li>
<li class="chapter" data-level="4.3" data-path="sensi.html"><a href="sensi.html#drift"><i class="fa fa-check"></i><b>4.3</b> Drift</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lsmc.html"><a href="lsmc.html"><i class="fa fa-check"></i><b>5</b> Longstaff Schwartz</a></li>
<li class="chapter" data-level="6" data-path="scen.html"><a href="scen.html"><i class="fa fa-check"></i><b>6</b> Scenario</a></li>
<li class="chapter" data-level="7" data-path="quirk.html"><a href="quirk.html"><i class="fa fa-check"></i><b>7</b> Quirkiness</a><ul>
<li class="chapter" data-level="7.1" data-path="quirk.html"><a href="quirk.html#inversion"><i class="fa fa-check"></i><b>7.1</b> Inversion</a><ul>
<li class="chapter" data-level="7.1.1" data-path="quirk.html"><a href="quirk.html#delta"><i class="fa fa-check"></i><b>7.1.1</b> Delta</a></li>
<li class="chapter" data-level="7.1.2" data-path="quirk.html"><a href="quirk.html#vega"><i class="fa fa-check"></i><b>7.1.2</b> Vega</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="quirk.html"><a href="quirk.html#gap"><i class="fa fa-check"></i><b>7.2</b> Gap</a></li>
<li class="chapter" data-level="7.3" data-path="quirk.html"><a href="quirk.html#qto"><i class="fa fa-check"></i><b>7.3</b> Qto</a></li>
<li class="chapter" data-level="7.4" data-path="quirk.html"><a href="quirk.html#correl-1"><i class="fa fa-check"></i><b>7.4</b> Correl</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="refer.html"><a href="refer.html"><i class="fa fa-check"></i><b>8</b> References</a></li>
<li class="divider"></li>
<li><a href="./">Unless otherwise stated,<br/>
all information here are<br/>
derived from public sources</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="volsurf" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Volatility Surface</h1>
<p>Exotic payoffs can be very sensitive to volatility. The existence of a term and skew structure on the volatility surface implies that an underlying is regarded as having <em>different</em> volatility at different spot or time. The sensitivity to volatility means that our estimation of the price needs to incorporate the entire surface as an input.</p>
<p>Before thinking about the implications of this, we should provide means of producing the surface. One way is to use the market data of option prices on an underlying to reconstruct the implied volatility surface. Below we demostrate how to construct the SPX implied volatility surface using option prices from CBOE.</p>
<p>CBOE<a href="http://www.cboe.com/delayedquote/quote-table-download" class="uri">http://www.cboe.com/delayedquote/quote-table-download</a> provides downloading of delayed option quotes. If we enter SPX as the index ticker we can obtain a table that looks like this:</p>
<pre><code>##                             Spec   PBid   PAsk CP Type
## 1   17 Feb 500.00 (SPXW1728B500) 1864.8 1868.5  C Euro
## 2 17 Feb 500.00 (SPXW1728B500-E) 1864.8 1868.5  C Euro
## 3   17 Feb 600.00 (SPXW1728B600) 1764.8 1768.5  C Euro
## 4 17 Feb 600.00 (SPXW1728B600-E) 1764.8 1768.5  C Euro
## 5   17 Feb 700.00 (SPXW1728B700) 1664.8 1668.5  C Euro
## 6 17 Feb 700.00 (SPXW1728B700-E) 1664.8 1668.5  C Euro</code></pre>
<p>The data contains enough information to reproduce an implied volatility that leads to the quoted price of an option.</p>
<div id="implied-vol-surface" class="section level2">
<h2><span class="header-section-number">2.1</span> Implied vol surface</h2>
<p>Generally the market data does not contain sufficient data points, we therefore make a decision to interpolate within the points. Here we create a 40 by 40 equidistance grid of points so that the plot will look smooth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_call &lt;-<span class="st"> </span><span class="kw">subset</span>(SPX.IV, Type ==<span class="st"> &quot;C&quot;</span>)
df_call$StrikePct =<span class="st"> </span>df_call$Strike/df_call$Spot
x &lt;-<span class="st"> </span>df_call$StrikePct
y &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(df_call$dtExpiry)
z &lt;-<span class="st"> </span>df_call$IVMid
s &lt;-<span class="st"> </span><span class="kw">interp</span>(x, y, z, <span class="dt">nx=</span><span class="dv">40</span>, <span class="dt">ny =</span> <span class="dv">40</span>, <span class="dt">linear =</span> T)
nrz =<span class="st"> </span><span class="kw">nrow</span>(s$z)
ncz =<span class="st"> </span><span class="kw">ncol</span>(s$z)
jet.colors =<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))
nbcol =<span class="st"> </span><span class="dv">100</span>
color =<span class="st"> </span><span class="kw">jet.colors</span>(nbcol)
zfacet =<span class="st"> </span>s$z[-<span class="dv">1</span>, -<span class="dv">1</span>] +<span class="st"> </span>s$z[-<span class="dv">1</span>, -ncz] +<span class="st"> </span>s$z[-nrz, -<span class="dv">1</span>] +<span class="st"> </span>s$z[-nrz, -ncz]
facetcol =<span class="st"> </span><span class="kw">cut</span>(zfacet, nbcol)
TTM &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.Date</span>(s$y, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>) -<span class="st"> </span>df_call$dtTrade[<span class="dv">1</span>])/<span class="dv">365</span>
<span class="kw">persp</span>(s$x, TTM, s$z *<span class="st"> </span><span class="dv">100</span>, <span class="dt">col =</span> color[facetcol], <span class="dt">xlab =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Moneyness&quot;</span>,
      <span class="dt">ylab =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Expiry (Yr)&quot;</span>, <span class="dt">zlab =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Volatility (%)&quot;</span>, <span class="dt">theta =</span> <span class="dv">40</span>,
      <span class="dt">phi =</span> <span class="dv">25</span>, <span class="dt">ticktype =</span> <span class="st">&quot;detailed&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/SPXdata_IV_plot-1.png" width="672" /></p>
<p>From the plot we see the volatility is moving in the opposite direction of <em>moneyness</em>. <em>Moneyness</em> was computed as the strike price divided by the spot price. We can understand also interpret this as the implied volatility being higher when strike price is lower than the spot price.</p>
<p>However this is not always true, there other sections of the surface (further strikes and expiries) where the curvature is differently shaped. That is, in far out (or in) of the region shown above, the shape can be upward sloping instead of downward sloping.</p>
</div>
<div id="local-vol-surface" class="section level2">
<h2><span class="header-section-number">2.2</span> Local vol surface</h2>
<p>TODO: Build LV surface using IV surface. Plot 3d chart. Show fluctuations if IV data points are not smooth.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="payoff.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
